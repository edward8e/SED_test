
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title></title>



    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Dosis:400,600,700" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/popup.css">



    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script type="text/javascript" src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <!-- <script type="text/javascript" src="/js/jquery.popup.js"></script> -->
    <script type="text/javascript" src="/js/plotly.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
  <script type="text/javascript" src="/js/jquery.popup.js"></script>

<link rel="stylesheet" type="text/css" href="css/style0.css">
 <link rel="stylesheet" type="text/css" href="css/style.css">

  </head>
  <body>


<div class="container">
  <h2 align="center" class="title-font">Spectral Energy Distribution (SED) for ARP 220:</h2>
  <div class="row">

    <div class="col-md-8">
      <div id="my-graph"></div>
    </div>
    <div class="col-md-4">
      <h3>Two types of Error Bar Options:</h3>
      <button type="button" class="btn btn-primary" id="ErrorBarOFF">Error Bar OFF</button>
      <button type="button" class="btn btn-primary" id="ErrorBarON">Error Bar ON</button>


      <div class="onoffswitch">
          <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch" checked>
          <label class="onoffswitch-label" for="myonoffswitch">
              <span class="onoffswitch-inner"></span>
              <span class="onoffswitch-switch"></span>
          </label>
      </div>

      <h4>Hover on and off</h4>
      <label class="switch">
        <input type="checkbox" name="onoffswitch1">
        <div class="slider"></div>
      </label>


      <h4>Show Spectral Lines</h4>
      <label class="switch">
        <input type="checkbox" name="onoffswitch2">
        <div class="slider"></div>
      </label><br><br>

      <label class="switch">
        <input type="checkbox">
        <div class="slider round"></div>
      </label><br><br>

      <label class="switch">
        <input type="checkbox" checked>
        <div class="slider round"></div>
      </label>

      <form>
        <span>X-Axis: </span>
        <select id ="ddl" name="ddl" onmousedown="this.value='';" onchange="jsFunction(this.value);">
          <option value="1">log(Frequency [Hz])</option>
          <option value="2">log(Wavelength [microns])</option>
        </select>
        <br />

        <span>Y-Axis: </span>
        <select id ="ddl" name="ddl" onmousedown="this.value='';" onchange="jsFunction1(this.value);">
          <option value="1">log(F_{nu} [Jy])</option>
          <option value="2">log(F_{nu} [W m^{-2} Hz(-1}])</option>
          <option value="3">log(nuF_{nu} [Jy-Hz])</option>
          <option value="4">log(nuF_{nu} [W m^{-2}])</option>
        </select>


      </form>





    </div>
  </div>

<div class="row table-responsive">
  <table class="table-info table table-bordered">
    <thead class="title-font">
      <tr class="table-center">
        <th></th>
        <th colspan="4" align="center">Published Units</th>
        <th colspan="8">Homogenized Units [Frequency, Flux Density]</th>
      </tr>

      <tr class="table-center">
        <th>No.</th>
        <th>Observed Passband</th>
        <th>Measurement</th>
        <th>Uncertainty</th>
        <th>Units</th>
        <th>Freq (Hz)</th>
        <th>Measurement</th>
        <th>Uncertainty</th>
        <th>Units</th>
        <th>Mode</th>
        <th>Aperture/Qualifiers</th>
        <th>Reference Code</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th id="hoverinfonum"></th>
        <th id="hoverinfoopassband"></th>
        <th id ="hoverinfomeasurement"></th>
        <th id="hoverinfouncertainty"></th>
        <th id="hoverinfounits"></th>
        <th id="hoverinfofrequency"></th>
        <th id="hoverinfomeasurement2"></th>
        <th id="hoverinfouncertainty2"></th>
        <th id="hoverinfounits2"></th>
        <th id="hoverinfomode"></th>
        <th id="hoverinfoaperture"></th>
        <th id="hoverinforcode"></th>
      </tr>
    </tbody>
  </table>
</div>



</div>



<script>
//pulls in the CSV file
Plotly.d3.csv('arp_220.csv', function(err, dataCSV){

  var x = [], y = [], t = [], s = [], type = [], number = [], errorBar = [],
  xline = [], yline = [], xWavelength = [];

  var OPassband = [], PMeasurement = [], Uncertainty = [], Units = [], Frequency = [], NEDMeasurement = [],
      NEDUncertainty = [], NEDUnits = [], Refcode = [], Significance = [], PFrequency = [], FMode = [], CTargeted = [],
      SMode = [], Qualifiers = [], Comments = [];
  dataCSV.forEach(function(p) {
          x.push(p['Frequency']);
          y.push(p['NED Photometry Measurement']);
          t.push(p['Comments']);
          s.push(p['Photometry Measurement']);
          type.push(p['Frequency Mode']);
          number.push(p['No.']);
          errorBar.push(p['NED Uncertainty']);
          xline.push(p['Frequency']);
          yline.push(p['NED Photometry Measurement']);

          //Table Data
          OPassband.push(p['Observed Passband']);
          PMeasurement.push(p['Photometry Measurement']);
          Uncertainty.push(p['Uncertainty']);
          Units.push(p['Units']);
          Frequency.push(p['Frequency']);
          NEDMeasurement.push(p['NED Photometry Measurement']);
          NEDUncertainty.push(p['NED Uncertainty']);
          NEDUnits.push(p['NED Units']);
          Refcode.push(p['Refcode']);
          Significance.push(p['Significance']);
          PFrequency.push(p['Published frequency']);
          FMode.push(p['Frequency Mode']);
          CTargeted.push(p['Coordinates Targeted']);
          SMode.push(p['Spatial Mode']);
          Qualifiers.push(p['Qualifiers']);
          Comments.push(p['Comments']);
      });

//---------------------Splits x and y broad-band and line points----------------------//
var arrayLength = type.length;
var i;
var out;

for(i = 0; i < arrayLength; i++)
{
  if (
    type[i] != ' Broad-band measurement'
    &&
    type[i] != ' Broad-band measurement; broad-band flux derived by integration over spectrum; synthetic band'){

    delete x[i];
    delete y[i];
  }
  else{
    out = true;
    delete xline[i];
    delete yline[i];
  }
}

//---------------------computes x Wavelength values----------------------//

for(i = 0; i < arrayLength; i++)
{
  xWavelength[i] = (299792458/x[i]) * 1000000;
}
console.log(xWavelength);



var errorBarNull = [];
//filters out the strings and removes "+/- syntax"
 for(var i = 0; i < arrayLength; i++)
 {
    errorBar[i] = errorBar[i].replace("+/-",""); //removes "+/-"
    errorBarNull[i] = 0;
 }





var data = [
      {mode: 'markers',
      type: "scatter",
      name: "SED Points",
      text: number,
      // marker:{color: 'rgb(0,0,139)'},
      //
      // marker: {symbol: 'circle-open'},
      x: x,
      y: y,
      error_y: {
        type: 'data',
        array: errorBar,
        visible: true,
        thickness: 1,
        // color: 'rgb(0,0,139)'
      }}
  ];

//Graph axis related things
var layout = {
  xaxis: {
    title: 'log v (Hz)',
    type:'log',
    autorange: true,
    linecolor: 'black',
    linewidth: 2,
    mirror: true,
    ticks: 'inside',
    ticklen: 10,
    tickwidth: 2,
    exponentformat: "power"
    },
  yaxis: {
    title: 'log f<sub>v</sub> (Jy)',
    type:'log',
    autorange: true,
    linecolor: 'black',
    linewidth: 2,
    mirror: true,
    ticks: 'inside',
    ticklen: 10,
    tickwidth: 2,
    exponentformat: "power"
    },
  margin: {t: 20},
  hovermode: false,
};

var toImage2 = {
  name: 'Download plot as a SVG',
  icon: Plotly.Icons.camera,
  click: function(gd) {
    Plotly.downloadImage(gd, {format: 'svg'})
  }
};


//Edits made to the toolbar
var toolbar = {
	scrollZoom: true, // lets us scroll to zoom in and out - works
	showLink: false, // removes the link to edit on plotly - works
	modeBarButtonsToRemove: ['select2d', 'lasso2d', 'sendDataToCloud'],
  displaylogo: false,
  modeBarButtonsToAdd: [toImage2]
};



//---------------------Error BARs Buttons----------------------//
// 1. Create the button
var button = document.getElementById("ErrorBarON").onclick = function() {

  var data_update = {
    error_y: {
      type: 'data',
      array: errorBar,
      visible: true,
      thickness: 1,
      // color: 'rgb(0,0,139)'
    }
};
    Plotly.update('my-graph', data_update);


};


// 1. Create the button
var button1 = document.getElementById("ErrorBarOFF").onclick = function() {

    var data_update = {
      error_y: {
        type: 'data',
        array: errorBarNull,
        visible: true,
        thickness: 0.001,
        // color: 'rgb(0,0,139)'
      }
  };
    Plotly.update('my-graph', data_update);


};

//---------------------Error Bar Switch----------------------//
//Error Bars
var checkbox = document.querySelector("input[name=onoffswitch]").onchange = function() {
if(this.checked) {
  //When Switch is on
  var data_update = {
    error_y: {
      type: 'data',
      array: errorBar,
      visible: true,
      thickness: 1,
      // color: 'rgb(0,0,139)'
    }};
    var layout_update = {};

    Plotly.update('my-graph', data_update, layout_update);
  } else {
    //when Switch is off
    var data_update = {
      error_y: {
        type: 'data',
        array: errorBarNull,
        visible: true,
        thickness: 0.001,
        // color: 'rgb(0,0,139)'
      }};
      var layout_update = {};

    Plotly.update('my-graph', data_update, layout_update);
  }
}


//---------------------Hover on and off----------------------//
var checkbox1 = document.querySelector("input[name=onoffswitch1]").onchange = function() {
if(this.checked) {
  //When switch is on
  var data_update = {};
    var layout_update = {
      hovermode: 'closest'
    };

    Plotly.update('my-graph', data_update, layout_update);
  } else {
    //when switch is off
    var data_update = {};
      var layout_update = {
        hovermode: false
      };

    Plotly.update('my-graph', data_update, layout_update);
  }
}

//---------------------Spectral lines on and off----------------------//
var checkbox2 = document.querySelector("input[name=onoffswitch2]").onchange = function() {
if(this.checked) {
  //When switch is on
  var trace_lines =
        {name: "Spectral Lines",
          mode: 'markers',
          type: "scatter",
          text: number,
          x: xline,
          y: yline,
          error_y: {
            type: 'data',
            array: errorBar,
            visible: true,
            thickness: 1,
            // color: 'rgb(0,0,139)'
          }}
    ;
    Plotly.addTraces('my-graph', trace_lines);
  } else {
    //when switch is off
    //Removes the SED Trace from graph
      Plotly.deleteTraces('my-graph', 1);
  }
}

//---------------------Change the X-Axis Dropdown----------------------//
var xaxis_update = jsFunction = function(value)
{
  if(value == 1){
    var data_update = {
      x: x
    };
      var layout_update = {
        xaxis: {
          title: 'log(Frequency [Hz])',
          type:'log',
          autorange: true,
          linecolor: 'black',
          linewidth: 2,
          mirror: true,
          ticks: 'inside',
          ticklen: 10,
          tickwidth: 2,
          exponentformat: "power"
          },
        margin: {t: 20},
      };
      Plotly.update('my-graph', data_update, layout_update);
  }
  else{
    var data_update = {
      x: xWavelength
    };
      var layout_update = {
        xaxis: {
          title: 'log(Wavelength [microns])',
          type:'log',
          autorange: true,
          linecolor: 'black',
          linewidth: 2,
          mirror: true,
          ticks: 'inside',
          ticklen: 10,
          tickwidth: 2,
          exponentformat: "power"
          },
        margin: {t: 20},
      };
    Plotly.update('my-graph', data_update, layout_update);
  }

}
//---------------------END of X-Axis----------------------//

//---------------------Change the Y-Axis Dropdown----------------------//
var yaxis_update = jsFunction1 = function(value)
{
  if(value == 1){
    var data_update = {};
      var layout_update = {
        yaxis: {
          title: 'log(F_{nu} [Jy])',
          type:'log',
          autorange: true,
          linecolor: 'black',
          linewidth: 2,
          mirror: true,
          ticks: 'inside',
          ticklen: 10,
          tickwidth: 2,
          exponentformat: "power"
          },
        margin: {t: 20},
      };
      Plotly.update('my-graph', data_update, layout_update);
  }
  else if(value == 2){
    var data_update = {};
      var layout_update = {
        yaxis: {
          title: 'log(F_{nu} [W m^{-2} Hz(-1}])',
          type:'log',
          autorange: true,
          linecolor: 'black',
          linewidth: 2,
          mirror: true,
          ticks: 'inside',
          ticklen: 10,
          tickwidth: 2,
          exponentformat: "power"
          },
        margin: {t: 20},
      };
      Plotly.update('my-graph', data_update, layout_update);
  }
  else if(value == 3){
    var data_update = {};
      var layout_update = {
        yaxis: {
          title: 'log(nuF_{nu} [Jy-Hz])',
          type:'log',
          autorange: true,
          linecolor: 'black',
          linewidth: 2,
          mirror: true,
          ticks: 'inside',
          ticklen: 10,
          tickwidth: 2,
          exponentformat: "power"
          },
        margin: {t: 20},
      };
      Plotly.update('my-graph', data_update, layout_update);
  }
  else{
    var data_update = {};
      var layout_update = {
        yaxis: {
          title: 'log(nuF_{nu} [W m^{-2}])',
          type:'log',
          autorange: true,
          linecolor: 'black',
          linewidth: 2,
          mirror: true,
          ticks: 'inside',
          ticklen: 10,
          tickwidth: 2,
          exponentformat: "power"
          },
        margin: {t: 20},
      };
      Plotly.update('my-graph', data_update, layout_update);
  }

}
//---------------------END of Y-Axis----------------------//






//Calls the plot into HTML
Plotly.newPlot('my-graph', data, layout, toolbar, button,
button1, checkbox, checkbox1, xaxis_update, yaxis_update, checkbox2);




//---------------------Pulls information into table----------------------//
//Event handler in plotly when it comes to hovering
var myPlot = document.getElementById('my-graph');
var hoverInfoNum = document.getElementById('hoverinfonum');
var hoverInfoOPassband = document.getElementById('hoverinfoopassband');
var hoverInfoMeasurement = document.getElementById('hoverinfomeasurement');
var hoverInfoUncertainty = document.getElementById('hoverinfouncertainty');
var hoverInfoUnits = document.getElementById('hoverinfounits');
var hoverInfoFrequency = document.getElementById('hoverinfofrequency');
var hoverInfoMeasurement2 = document.getElementById('hoverinfomeasurement2');
var hoverInfoUncertainty2 = document.getElementById('hoverinfouncertainty2');
var hoverInfoUnits2 = document.getElementById('hoverinfounits2');
var hoverInfoMode = document.getElementById('hoverinfomode');
var hoverInfoAperture = document.getElementById('hoverinfoaperture');
var hoverInfoRCode = document.getElementById('hoverinforcode');
var hoverInfoUnits2 = document.getElementById('hoverinfounits2');

myPlot.on('plotly_click', function(data){
//displays point number and acts as a counter for arrays
   var pts = '';
      for(var i=0; i < data.points.length; i++){
          pts = data.points[i].text;
      }
      var pCounter = pts - 1;


  //Display the Point number
   var numbertext = data.points.map(function(d){return (pts);});
   hoverInfoNum.innerHTML = numbertext.join('');
//Observed Passband
   var Opassbandtext = data.points.map(function(d){return(OPassband[pCounter]);});
   hoverInfoOPassband.innerHTML = Opassbandtext.join('');
//Measurement
   var Measurementtext = data.points.map(function(d){return(PMeasurement[pCounter]);});
   hoverInfoMeasurement.innerHTML = Measurementtext.join('');
//Uncertainty
   var Uncertaintytext = data.points.map(function(d){return(Uncertainty[pCounter]);});
   hoverInfoUncertainty.innerHTML = Uncertaintytext.join('');
//Units
   var Unitstext = data.points.map(function(d){return(Units[pCounter]);});
   hoverInfoUnits.innerHTML = Unitstext.join('');
//Frequency
   var Frequencytext = data.points.map(function(d){return(Frequency[pCounter]);});
   hoverInfoFrequency.innerHTML = Frequencytext.join('');
//Measurement2
   var Measurement2text = data.points.map(function(d){return(NEDMeasurement[pCounter]);});
   hoverInfoMeasurement2.innerHTML = Measurement2text.join('');
//Uncertainty2
   var Uncertainty2text = data.points.map(function(d){return(NEDUncertainty[pCounter]);});
   hoverInfoUncertainty2.innerHTML = Uncertainty2text.join('');
//Units2
   var Units2text = data.points.map(function(d){return(NEDUnits[pCounter]);});
   hoverInfoUnits2.innerHTML = Units2text.join('');
//Mode
   var Modetext = data.points.map(function(d){return(FMode[pCounter]);});
   hoverInfoMode.innerHTML = Modetext.join('');
//Aperture
   var Aperturetext = data.points.map(function(d){return(Qualifiers[pCounter]);});
   hoverInfoAperture.innerHTML = Aperturetext.join('');
//Reference Code
   var Referencetext = data.points.map(function(d){return(Refcode[pCounter]);});
   hoverInfoRCode.innerHTML = Referencetext.join('');
});

//---------------------END OF TABLE----------------------//





});




</script>
<style>


</style>



  </body>
</html>
